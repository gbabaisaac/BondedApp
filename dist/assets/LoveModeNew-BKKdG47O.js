import{j as e,g as y,X as w,x as V,H as A,m as Y,b as S,O as J,Q as K,w as X,U as G}from"./ui-vendor-D_t-keVG.js";import{r as l}from"./react-vendor-VqAh-rcM.js";import{C as m,B as d,c as N,e as B,p as h,b as g}from"./index-BYJfFurX.js";import{B as z}from"./MainApp-DUpXIKYd.js";import"./supabase-vendor-l2BGu7mn.js";function Z({onComplete:i,onActivate:s}){return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs(m,{style:{maxWidth:"500px",padding:"32px",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px"},children:"ðŸ’• Dating Mode"}),e.jsx("p",{style:{marginBottom:"24px",color:"#666"},children:"Welcome to dating mode! This feature is coming soon."}),e.jsx(d,{onClick:s||i,children:"Continue"})]})})}function _({onComplete:i}){return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs(m,{style:{maxWidth:"500px",padding:"32px",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px"},children:"â­ Rating Feature"}),e.jsx("p",{style:{color:"#666"},children:"Coming soon..."})]})})}function ee({onComplete:i,onSkip:s}){return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs(m,{style:{maxWidth:"500px",padding:"32px",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px"},children:"ðŸ’• Love Print Quiz"}),e.jsx("p",{style:{color:"#666"},children:"Coming soon..."})]})})}function te({relationshipId:i,onBack:s}){return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs(m,{style:{maxWidth:"500px",padding:"32px",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px"},children:"ðŸ’¬ Blind Chat"}),e.jsx("p",{style:{color:"#666"},children:"Coming soon..."})]})})}function se({relationshipId:i,onBack:s}){return e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:e.jsxs(m,{style:{maxWidth:"500px",padding:"32px",textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"16px"},children:"ðŸŽ‰ Bond Reveal"}),e.jsx("p",{style:{color:"#666"},children:"Coming soon..."})]})})}const P=l.forwardRef(({className:i,...s},n)=>e.jsx("div",{ref:n,className:N("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",i),...s}));P.displayName="Avatar";const L=l.forwardRef(({className:i,...s},n)=>e.jsx("img",{ref:n,className:N("aspect-square h-full w-full",i),...s}));L.displayName="AvatarImage";const R=l.forwardRef(({className:i,...s},n)=>e.jsx("div",{ref:n,className:N("flex h-full w-full items-center justify-center rounded-full bg-muted",i),...s}));R.displayName="AvatarFallback";function le({onExit:i}){const s=B(t=>t.userProfile),n=B(t=>t.accessToken),[W,v]=l.useState(!1),[$,M]=l.useState(!0),[j,a]=l.useState("onboarding"),[c,o]=l.useState("matches"),[p,H]=l.useState([]),[f,b]=l.useState(null),[k,I]=l.useState(null);l.useEffect(()=>{T()},[]);const T=async()=>{try{const t=await fetch(`https://${h}.supabase.co/functions/v1/make-server-2516be19/love-mode/activation-status`,{headers:{Authorization:`Bearer ${n}`}});if(t.ok){const r=await t.json();v(r.isActivated||!1),r.isActivated&&(s.lovePrint?(o("matches"),a("matches"),x()):a("lovePrintQuiz"))}else v(!1)}catch(t){console.error("Check activation error:",t),v(!1)}finally{M(!1)}},O=async()=>{try{if((await fetch(`https://${h}.supabase.co/functions/v1/make-server-2516be19/love-mode/activate`,{method:"POST",headers:{Authorization:`Bearer ${n}`}})).ok)v(!0),s.lovePrint?(o("discover"),a("rating")):a("lovePrintQuiz"),g.success("Welcome to Love Mode! ðŸ’œ"),x();else throw new Error("Failed to activate")}catch(t){console.error("Activate Love Mode error:",t),g.error("Failed to activate Love Mode")}},F=async t=>{try{(await fetch(`https://${h}.supabase.co/functions/v1/make-server-2516be19/love-mode/love-print`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({lovePrint:t})})).ok&&(g.success("Love Print complete! Now let's find your matches."),o("discover"),a("rating"))}catch(r){console.error("Save Love Print error:",r),g.error("Failed to save Love Print")}},Q=()=>{o("discover"),a("rating")},x=async()=>{try{const t=await fetch(`https://${h}.supabase.co/functions/v1/make-server-2516be19/love-mode/relationships`,{headers:{Authorization:`Bearer ${n}`}});if(t.ok){const r=await t.json();H(r.relationships||[])}}catch(t){console.error("Load relationships error:",t)}},D=()=>{x(),o("matches"),a("matches")},q=async t=>{b(t),t.revealed&&await C(t.partnerId),a("chat")},C=async t=>{try{const r=await fetch(`https://${h}.supabase.co/functions/v1/make-server-2516be19/profile/${t}`,{headers:{Authorization:`Bearer ${n}`}});if(r.ok){const u=await r.json();I(u)}}catch(r){console.error("Load partner profile error:",r)}},U=async()=>{try{const t=await fetch(`https://${h}.supabase.co/functions/v1/make-server-2516be19/love-mode/relationships`,{headers:{Authorization:`Bearer ${n}`}});if(t.ok){const u=(await t.json()).relationships.find(E=>E.id===f.id);u?.revealed&&(await C(u.partnerId),b(u),a("reveal"))}}catch(t){console.error("Check reveal status error:",t)}};return $?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-pink-50 to-purple-50",children:e.jsx(y,{className:"w-12 h-12 text-pink-500 animate-pulse"})}):W?j==="lovePrintQuiz"?e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50",children:[e.jsx("div",{className:"absolute top-3 left-3 sm:top-4 sm:left-4 z-50 safe-top",children:e.jsx(d,{variant:"ghost",size:"icon",onClick:i,className:"bg-white/80 backdrop-blur-sm hover:bg-white shadow-lg touch-manipulation",style:{minWidth:"44px",minHeight:"44px"},children:e.jsx(w,{className:"w-5 h-5"})})}),e.jsx(ee,{onComplete:F,onSkip:Q})]}):j==="rating"?e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-pink-50 via-purple-50 to-red-50",children:[e.jsx("div",{className:"absolute top-3 left-3 sm:top-4 sm:left-4 z-50 safe-top",children:e.jsx(d,{variant:"ghost",size:"icon",onClick:i,className:"bg-white/80 backdrop-blur-sm hover:bg-white shadow-lg touch-manipulation",style:{minWidth:"44px",minHeight:"44px"},children:e.jsx(w,{className:"w-5 h-5"})})}),e.jsx(_,{userProfile:s,accessToken:n,onRatingComplete:D})]}):j==="chat"&&f?e.jsx(te,{relationship:f,userProfile:s,accessToken:n,onBack:()=>{b(null),o("matches"),a("matches"),x()},onRevealRequested:U}):j==="reveal"&&f&&k?e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-pink-50 via-purple-50 to-red-50",children:[e.jsx("div",{className:"absolute top-3 left-3 sm:top-4 sm:left-4 z-50 safe-top",children:e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>{o("matches"),a("matches"),b(null),x()},className:"bg-white/80 backdrop-blur-sm hover:bg-white shadow-lg touch-manipulation",style:{minWidth:"44px",minHeight:"44px"},children:e.jsx(w,{className:"w-5 h-5"})})}),e.jsx(se,{relationship:f,userProfile:s,partnerProfile:k,accessToken:n,onContinueChat:()=>a("chat")})]}):e.jsxs("div",{className:"fixed inset-0 flex flex-col bg-gradient-to-br from-pink-50 via-purple-50 to-blue-50",style:{height:"100dvh",overflow:"hidden"},children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-pink-100 z-10 flex-shrink-0 safe-top",children:e.jsx("div",{className:"max-w-4xl mx-auto px-3 sm:px-4 py-3 sm:py-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:i,className:"hover:bg-pink-50 flex-shrink-0 touch-manipulation",style:{minWidth:"44px",minHeight:"44px"},children:e.jsx(V,{className:"w-5 h-5"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx(A,{className:"w-4 h-4 sm:w-5 sm:h-5 text-pink-500 flex-shrink-0"}),e.jsx("h1",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent truncate",children:"Love Mode"})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-600 truncate",children:"Where hearts connect first"})]})]}),c==="matches"&&e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{o("discover"),a("rating")},className:"border-pink-200 hover:bg-pink-50 flex-shrink-0 touch-manipulation hidden sm:flex",style:{minHeight:"36px"},children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Rate More"})]})]})})}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0",children:e.jsx("div",{className:"h-full overflow-y-auto overflow-x-hidden",style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",paddingBottom:"calc(5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"max-w-4xl mx-auto px-3 sm:px-4 py-4 sm:py-8 w-full",children:p.length===0?e.jsxs(m,{className:"p-6 sm:p-12 text-center",children:[e.jsx(A,{className:"w-12 h-12 sm:w-16 sm:h-16 text-pink-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-2",children:"No Matches Yet"}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mb-6 px-2",children:["Keep rating profiles to help our AI understand your type.",e.jsx("br",{className:"hidden sm:block"}),e.jsx("span",{className:"sm:hidden",children:" "}),"We'll notify you when you have a match!"]}),e.jsxs(d,{onClick:()=>{o("discover"),a("rating")},className:"bg-gradient-to-r from-pink-500 to-purple-500 touch-manipulation",style:{minHeight:"44px"},children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Start Rating"]})]}):e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-3 sm:mb-4 px-1",children:"Your Connections"}),p.map(t=>e.jsx(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(m,{className:"p-4 sm:p-6 cursor-pointer hover:shadow-lg active:scale-[0.98] transition-all border-2 hover:border-pink-200 touch-manipulation",onClick:()=>q(t),style:{minHeight:"80px"},children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 flex-1",children:[t.revealed?e.jsxs(P,{className:"w-14 h-14 sm:w-16 sm:h-16 border-2 border-pink-200 flex-shrink-0",children:[e.jsx(L,{src:t.partnerPhoto}),e.jsx(R,{className:"bg-pink-100 text-pink-700 text-base sm:text-lg",children:t.partnerName?.[0]})]}):e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-gradient-to-r from-pink-200 to-purple-200 flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-500"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg truncate",children:t.revealed?t.partnerName:t.anonymousName||"Mystery Match"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[e.jsxs(z,{variant:"secondary",className:`text-[10px] sm:text-xs ${t.bondStrength>=75?"bg-pink-100 text-pink-700":t.bondStrength>=50?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:["Bond: ",t.bondStrength,"%"]}),t.unreadCount>0&&e.jsxs(z,{className:"bg-red-500 text-white text-[10px] sm:text-xs",children:[t.unreadCount," new"]})]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[t.revealed?e.jsx(J,{className:"w-5 h-5 sm:w-6 sm:h-6 text-pink-500"}):e.jsx(S,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-400"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mt-1 sm:mt-2 whitespace-nowrap",children:t.lastMessage?new Date(t.lastMessageAt).toLocaleDateString():"Start chatting"})]})]})})},t.id))]})})})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50 flex-shrink-0 safe-bottom",style:{paddingTop:"4px",paddingBottom:"max(4px, env(safe-area-inset-bottom))",boxShadow:"0 -2px 10px rgba(0, 0, 0, 0.05)"},children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-around h-16 px-2",children:[e.jsxs("button",{onClick:()=>{o("discover"),a("rating")},className:`flex flex-col items-center justify-center flex-1 h-full transition-colors touch-manipulation relative ${c==="discover"?"text-pink-600":"text-gray-500 active:text-gray-700"}`,style:{minHeight:"44px"},children:[e.jsx(K,{className:`w-6 h-6 ${c==="discover"?"fill-current":""}`}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium mt-0.5",children:"Discover"})]}),e.jsxs("button",{onClick:()=>{o("matches"),a("matches"),x()},className:`relative flex flex-col items-center justify-center flex-1 h-full transition-colors touch-manipulation ${c==="matches"?"text-pink-600":"text-gray-500 active:text-gray-700"}`,style:{minHeight:"44px"},children:[e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:`w-6 h-6 ${c==="matches"?"fill-current":""}`}),p.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-pink-500 text-white text-[10px] font-semibold rounded-full w-5 h-5 flex items-center justify-center min-w-[20px]",children:p.length>9?"9+":p.length})]}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium mt-0.5",children:"Matches"})]}),e.jsxs("button",{onClick:()=>{o("profile"),g.info("Profile view coming soon!")},className:`flex flex-col items-center justify-center flex-1 h-full transition-colors touch-manipulation ${c==="profile"?"text-pink-600":"text-gray-500 active:text-gray-700"}`,style:{minHeight:"44px"},children:[e.jsx(G,{className:`w-6 h-6 ${c==="profile"?"fill-current":""}`}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium mt-0.5",children:"Profile"})]})]})})})]}):e.jsx(Z,{onActivate:O})}export{le as LoveModeNew};
