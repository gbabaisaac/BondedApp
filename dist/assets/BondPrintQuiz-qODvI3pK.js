import{r as n,j as e}from"./radix-vendor-D14C15Ff.js";import{m as l,C as N,e as v,B as d,p as m}from"./index-M3q6TuVL.js";import{P as $}from"./progress-BDyDl-qk.js";import{b as o}from"./ui-vendor-BZRxtcfS.js";import{H as k,a as u,d as P,a4 as S,h as z}from"./icons-vendor-DY0DtMnS.js";import{A as D}from"./index-CppVJ9fv.js";import"./supabase-vendor-BE7OkBLE.js";import"./react-vendor-B2m46t8p.js";function L({userProfile:B,accessToken:c,onComplete:C,onSkip:p}){const[Q,q]=n.useState(!1),[h,x]=n.useState(!1),[t,f]=n.useState(null),[i,g]=n.useState(null),[j,b]=n.useState(!1),[A,y]=n.useState(!1),F=async()=>{x(!0);try{const s=await fetch(`https://${m}.supabase.co/functions/v1/make-server-2516be19/bond-print/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({userProfile:B})});if(!s.ok){const a=await s.json();throw console.error("Quiz start failed:",a),new Error(a.error||"Failed to start quiz")}const r=await s.json();f(r),q(!0)}catch(s){console.error("Error starting quiz:",s),o.error(s.message||"Failed to start quiz. Please try again.")}finally{x(!1)}},O=async()=>{if(!(!i||!t)){b(!0);try{const s=await fetch(`https://${m}.supabase.co/functions/v1/make-server-2516be19/bond-print/answer`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({answer:i,questionText:t.question})});if(!s.ok){const a=await s.json();throw console.error("Answer submission failed:",a),new Error(a.error||"Failed to submit answer")}const r=await s.json();g(null),r.completed?await E():f(r)}catch(s){console.error("Error submitting answer:",s),o.error(s.message||"Failed to submit answer. Please try again.")}finally{b(!1)}}},E=async()=>{y(!0);try{const s=await fetch(`https://${m}.supabase.co/functions/v1/make-server-2516be19/bond-print/generate`,{method:"POST",headers:{Authorization:`Bearer ${c}`}});if(!s.ok){const a=await s.json();throw console.error("Bond Print generation failed:",a),new Error(a.error||"Failed to generate Bond Print")}const r=await s.json();o.success("Your Bond Print is ready! ðŸŽ‰"),C(r.bondPrint)}catch(s){console.error("Error generating Bond Print:",s),o.error(s.message||"Failed to generate Bond Print. Please try again."),y(!1)}};if(!Q)return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-50 via-pink-50 to-purple-50 overflow-y-auto p-4",style:{height:"100dvh",WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y"},children:e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-lg w-full mx-auto",children:e.jsx(N,{className:"border-2 border-purple-200",children:e.jsxs(v,{className:"p-8",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(k,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-3xl text-center mb-3",children:"Create Your Bond Print"}),e.jsx("p",{className:"text-center text-gray-600 mb-8",children:"Complete this quick quiz to create your Bond Print - a personalized profile that helps us match you with compatible friends, roommates, study partners, and collaborators on campus. We'll use this to suggest people you'll find interesting and help facilitate meaningful connections!"}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(u,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-1",children:"AI-Powered & Adaptive"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Questions adapt based on your answers for deeper insights"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(k,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-1",children:"Personalized Matching"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Find friends, roommates, and love interests (if you want!)"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(P,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-1",children:"Quick & Easy"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Only 8 questions, takes about 3 minutes"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(d,{onClick:F,disabled:h,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 gap-2",size:"lg",children:h?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-5 h-5 animate-spin"}),"Preparing Your Quiz..."]}):e.jsxs(e.Fragment,{children:["Start Bond Print Quiz",e.jsx(z,{className:"w-5 h-5"})]})}),p&&e.jsx(d,{onClick:p,variant:"ghost",className:"w-full",children:"Skip for now"})]})]})})})});if(A)return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-50 via-pink-50 to-purple-50 flex items-center justify-center p-4",style:{height:"100dvh",WebkitOverflowScrolling:"touch"},children:e.jsxs(l.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(u,{className:"w-12 h-12 text-white animate-pulse"})}),e.jsx("h2",{className:"text-2xl mb-3",children:"Analyzing Your Responses..."}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Creating your unique Bond Print"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})});if(!t)return null;const w=t.questionNumber/t.totalQuestions*100;return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-purple-50 via-pink-50 to-purple-50 overflow-y-auto p-4",style:{height:"100dvh",WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",touchAction:"pan-y"},children:e.jsx(l.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"max-w-2xl w-full mx-auto",children:e.jsx(N,{className:"border-2 border-purple-200",children:e.jsxs(v,{className:"p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",t.questionNumber," of ",t.totalQuestions]}),e.jsxs("span",{className:"text-sm font-medium text-purple-600",children:[Math.round(w),"%"]})]}),e.jsx($,{value:w,className:"h-2"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(u,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-2xl pt-1",children:t.question})]}),e.jsx("div",{className:"space-y-3",children:e.jsx(D,{mode:"wait",children:t.options.map((s,r)=>e.jsx(l.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:r*.05},onClick:()=>g(s),className:`w-full text-left p-4 rounded-xl border-2 transition-all ${i===s?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 ${i===s?"border-purple-500 bg-purple-500":"border-gray-300"}`,children:i===s&&e.jsx(P,{className:"w-3 h-3 text-white"})}),e.jsx("span",{className:i===s?"text-purple-900 font-medium":"text-gray-700",children:s})]})},s))})})]}),e.jsx(d,{onClick:O,disabled:!i||j,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 gap-2",size:"lg",children:j?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-5 h-5 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[t.questionNumber===t.totalQuestions?"Finish Quiz":"Next Question",e.jsx(z,{className:"w-5 h-5"})]})})]})})},t.questionNumber)})}export{L as BondPrintQuiz};
