import{r as s,j as e}from"./radix-vendor-D14C15Ff.js";import{C as b,e as S,B as c}from"./index-M3q6TuVL.js";import{a6 as N,X as v,a7 as P}from"./icons-vendor-DY0DtMnS.js";import"./supabase-vendor-BE7OkBLE.js";import"./react-vendor-B2m46t8p.js";import"./ui-vendor-BZRxtcfS.js";function B(){const[o,l]=s.useState(null),[h,t]=s.useState(!1),[p,x]=s.useState(!1),[f,w]=s.useState(!1);s.useEffect(()=>{const a=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://");w(a);const r=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;x(r);const i=localStorage.getItem("installPromptDismissed"),j=i?parseInt(i):0,g=(Date.now()-j)/(1e3*60*60*24);if(!a&&(!i||g>7))if(r)t(!0);else{const d=m=>{m.preventDefault(),l(m),t(!0)};return window.addEventListener("beforeinstallprompt",d),()=>window.removeEventListener("beforeinstallprompt",d)}},[]);const u=async()=>{if(o){o.prompt();const{outcome:a}=await o.userChoice;a==="accepted"&&(console.log("User accepted the install prompt"),window.posthog&&window.posthog.capture("pwa_installed",{platform:"android"})),l(null),t(!1),localStorage.setItem("installPromptDismissed",Date.now().toString())}},n=()=>{t(!1),localStorage.setItem("installPromptDismissed",Date.now().toString())};return!h||f?null:e.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:w-96",children:e.jsx(b,{className:"border-2 border-[#2E7B91] shadow-lg bg-white",children:e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#2E7B91] to-[#25658A] rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(N,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-[#1E4F74] text-sm",children:"Install Bonded"}),e.jsx("p",{className:"text-xs text-[#64748b] mt-0.5",children:"Get the full app experience"})]}),e.jsx("button",{onClick:n,className:"text-[#64748b] hover:text-[#1E4F74] flex-shrink-0",children:e.jsx(v,{className:"w-4 h-4"})})]}),p?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-[#475569] mb-2",children:"To install on iPhone/iPad:"}),e.jsxs("ol",{className:"text-xs text-[#475569] space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Tap the Share button ",e.jsx("span",{className:"font-semibold",children:"□↑"})," at the bottom"]}),e.jsxs("li",{children:["Scroll down and tap ",e.jsx("span",{className:"font-semibold",children:'"Add to Home Screen"'})]}),e.jsxs("li",{children:["Tap ",e.jsx("span",{className:"font-semibold",children:'"Add"'})," to confirm"]})]}),e.jsx(c,{onClick:n,size:"sm",className:"w-full mt-2 bg-[#2E7B91] hover:bg-[#25658A] text-white text-xs",children:"Got it!"})]}):e.jsxs(c,{onClick:u,size:"sm",className:"w-full mt-2 bg-gradient-to-r from-[#2E7B91] to-[#25658A] hover:from-[#25658A] hover:to-[#1E4F74] text-white",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Install App"]})]})]})})})})}export{B as InstallAppPrompt};
